---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  eval = FALSE
)
```

# huggingfaceR v2.0

<!-- badges: start -->
<!-- badges: end -->

**The tidyverse gateway to Hugging Face** - An API-first R package for accessing 500,000+ models, embeddings, and datasets.

## âœ¨ What's New in v2.0

- **ðŸš€ No Python Required** - API-first design using Hugging Face Inference API
- **ðŸ“¦ Tidyverse Native** - Returns tibbles, works with pipes (`|>`)
- **ðŸ¤– Modern AI Tasks** - Text classification, embeddings, chat, generation
- **ðŸ”§ ML Integration** - Works with tidymodels and tidytext
- **âš¡ Simple Setup** - Just set your token and start coding

## Installation

Install from GitHub:

```{r eval = FALSE}
# install.packages("devtools")
devtools::install_github("farach/huggingfaceR")
```

## Quick Start

### 1. Authentication

Get your free API token from [huggingface.co/settings/tokens](https://huggingface.co/settings/tokens):

```{r}
library(huggingfaceR)

# Set your token (one-time setup)
hf_set_token("hf_xxxxxxxxxxxxx")

# Verify it works
hf_whoami()
```

### 2. Text Classification

```{r}
# Sentiment analysis
hf_classify("I love using R for data science!")
#> # A tibble: 1 Ã— 3
#>   text                                 label    score
#>   <chr>                                <chr>    <dbl>
#> 1 I love using R for data science!     POSITIVE 0.999

# Classify into custom categories (zero-shot)
hf_classify_zero_shot(
  "I just bought a new laptop for coding",
  labels = c("technology", "sports", "politics", "food")
)
#> # A tibble: 4 Ã— 3
#>   text                                  label      score
#>   <chr>                                 <chr>      <dbl>
#> 1 I just bought a new laptop for coding technology 0.892
#> 2 I just bought a new laptop for coding politics   0.045
#> ...
```

### 3. Embeddings for Semantic Analysis

```{r}
# Generate embeddings
sentences <- c(
  "The cat sat on the mat",
  "The dog played in the park",
  "A feline rested on the rug"
)

embeddings <- hf_embed(sentences)
embeddings
#> # A tibble: 3 Ã— 3
#>   text                          embedding    n_dims
#>   <chr>                         <list>       <int>
#> 1 The cat sat on the mat        <dbl [384]>  384
#> 2 The dog played in the park    <dbl [384]>  384
#> 3 A feline rested on the rug    <dbl [384]>  384

# Find similar sentences
hf_similarity(embeddings)
#> # A tibble: 3 Ã— 3
#>   text_1                     text_2                        similarity
#>   <chr>                      <chr>                         <dbl>
#> 1 The cat sat on the mat     A feline rested on the rug    0.89
#> 2 The cat sat on the mat     The dog played in the park    0.45
#> ...
```

### 4. LLM Chat

```{r}
# Ask questions to open-source LLMs
hf_chat("What is the capital of France?")
#> # A tibble: 1 Ã— 4
#>   role      content                           model                    tokens_used
#>   <chr>     <chr>                             <chr>                    <int>
#> 1 assistant The capital of France is Paris... mistralai/Mistral-7B...  42

# Multi-turn conversations
convo <- hf_conversation(system = "You are a helpful R programming tutor.")
convo <- chat(convo, "How do I read a CSV file?")
convo <- chat(convo, "What about reading Excel files?")
print(convo)
```

### 5. Text Generation

```{r}
# Continue text
hf_generate("Once upon a time in a land far away,", max_new_tokens = 50)

# Fill in the blank
hf_fill_mask("The capital of France is [MASK].")
#> # A tibble: 5 Ã— 4
#>   text                              token  score filled
#>   <chr>                             <chr>  <dbl> <chr>
#> 1 The capital of France is [MASK].  Paris  0.89  The capital of France is Paris.
#> ...
```

## Tidyverse Integration

### Works seamlessly with dplyr

```{r}
library(dplyr)

reviews <- tibble(
  id = 1:3,
  text = c(
    "This product is amazing!",
    "Terrible experience, would not recommend.",
    "It's okay, nothing special."
  )
)

reviews |>
  mutate(sentiment = hf_classify(text)) |>
  unnest(sentiment) |>
  select(id, text, label, score)
```

### Tidymodels Integration

```{r}
library(tidymodels)

# Use embeddings as features in ML models
rec <- recipe(sentiment ~ review_text, data = train_data) |>
  step_hf_embed(review_text)

wf <- workflow() |>
  add_recipe(rec) |>
  add_model(logistic_reg()) |>
  fit(data = train_data)
```

### Tidytext Integration

```{r}
library(tidytext)

docs <- tibble(
  doc_id = 1:100,
  text = c(...)  # your documents
)

# Embed and find similar documents
docs_embedded <- docs |>
  hf_embed_text(text)

docs_embedded |>
  hf_nearest_neighbors("machine learning", k = 5)

# Cluster by semantic similarity
docs_embedded |>
  hf_cluster_texts(k = 5)
```

## Explore Models and Datasets

```{r}
# Search for models
hf_search_models(
  task = "text-classification",
  sort = "downloads",
  limit = 10
)

# Get model info
hf_model_info("sentence-transformers/all-MiniLM-L6-v2")

# List available tasks
hf_list_tasks()

# Load datasets via API (no Python needed!)
imdb <- hf_load_dataset("imdb", split = "train", limit = 1000)
```

## Advanced: Local Inference (Optional)

For users who need local model inference, huggingfaceR v2 still supports the legacy Python/reticulate workflow. See the [Advanced Local Inference vignette](vignettes/advanced-local-inference.Rmd) for details.

## Migration from v1

If you're upgrading from huggingfaceR v1.x:

- âœ… **Legacy functions still work** - Your old code won't break
- ðŸ“¢ **Deprecation warnings** - Guide you to new equivalents
- ðŸ“š **Migration guide** - See `vignette("migration-guide")`

Key changes:
- `hf_load_pipeline()` â†’ Use task-specific functions like `hf_classify()`, `hf_embed()`
- `hf_inference()` with payloads â†’ Use direct functions
- Python environment no longer auto-configured â†’ Set API token instead

## Learn More

- [Getting Started Guide](vignettes/getting-started.Rmd)
- [Embeddings & Tidytext](vignettes/embeddings-tidytext.Rmd)
- [LLM Chat](vignettes/llm-chat.Rmd)
- [Tidymodels Integration](vignettes/tidymodels-integration.Rmd)
- [API Documentation](https://huggingface.co/docs/api-inference/index)

## License

MIT Â© Alex Farach, Sam Terfa, Jack Penzer
