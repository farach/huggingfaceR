---
title: "ez_functions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ez_functions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, message=FALSE}
library(tidyverse)
library(huggingfaceR)
```

## Introduction to EZ Functions

huggingface models are trained to perform one of several tasks. For a list of tasks, you can run `hf_list_tasks()`.

```{r huggingface_tasks_table, echo=FALSE}

tasks <- hf_list_tasks()

tasks_len <- length(tasks)

next_multiple_of_3 <- tasks_len + (0:2)[(tasks_len + 0:2) %% 3 == 0]

tasks_tbl <- tasks %>% append(rep('', next_multiple_of_3 - tasks_len)) %>%  matrix(ncol = 3, byrow = TRUE) %>% as.data.frame()

knitr::kable(tasks_tbl, row.names = NA, col.names = NULL, caption = 'Huggingface Tasks')
```

EZ functions are a simple way to get started with models for a given task. More advanced users familiar with huggingface models can load pipelines and models directly.

1.  *Beginners* --> `hf_ez_{task}`
2.  *Intermediate Users* --> `hf_load_pipeline()`
3.  *Advanced Users* --> `hf_load_tokenizer()` + `hf_load_model()` + `hf_load_AutoModel_for_task()`

So far huggingfaceR has ez functions for NLP tasks only.

```{r huggingfaceR_tasks_table, echo=FALSE}

tasks <- ls('package:huggingfaceR', pattern = "hf_ez_")

tasks_len <- length(tasks)

next_multiple_of_3 <- tasks_len + (0:2)[(tasks_len + 0:2) %% 3 == 0]

tasks_tbl <- tasks %>% append(rep('', next_multiple_of_3 - tasks_len)) %>%  matrix(ncol = 3, byrow = TRUE) %>% as.data.frame()

knitr::kable(tasks_tbl, row.names = NA, col.names = NULL, caption = 'Implemented EZ Functions')
```

## EZ Functions in Action

Let's say you'd like to automagically label the sentiment of a text as positive or negative. While you could use a text classification pre-trained model to do this, you can instead use a more generally useful zero-shot-classification model which can label text based on *any* labels you feed it. Then if you change your mind and decide that you'd like to change the labels to happy, ambivalent, and sad, you won't need to find a model explicitly trained on those sentiments! 

For some sample data, we can search hugginface's datasets for a suitable set of texts. 

```{r dataset}

datasets <- hf_list_datasets(pattern = "sentiment")

datasets
```

The sentiment140 dataset sounds like a good candidate. Let's load 50 rows from its training set.

```{r}

dataset <- hf_load_dataset(dataset = "sentiment140", split="train[0:50]")

dataset

```

EZ functions take two arguments: `model_id` and `use_api`. The default argument for `use_api` is FALSE, but you can simply set it to TRUE if wishing to use the inference API. `model_id` should be a string which refers to a  model stored on the Hugging Face Hub. You could use the huggingfaceR function `hf_list_models()` or the `huggingfaceR::models_with_downloads` data set to find the appropriate model for the EZ function of your choice.

Let's say you'd like to 

### Demonstration of an EZ pipeline using a local model

### Demonstration of an EZ pipeline using Inference API

