<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Embeddings, Similarity, and Semantic Search • huggingfaceR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Embeddings, Similarity, and Semantic Search">
<link rel="icon" type="image/svg+xml" href="favicon/favicon.svg">
<meta property="og:image" content="https://farach.github.io/huggingfaceR/logo.svg">
<meta name="twitter:card" content="summary">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">huggingfaceR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book-open"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with huggingfaceR</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core Capabilities</h6></li>
    <li><a class="dropdown-item" href="../articles/text-classification.html">Text Classification</a></li>
    <li><a class="dropdown-item" href="../articles/embeddings-and-similarity.html">Embeddings and Similarity</a></li>
    <li><a class="dropdown-item" href="../articles/llm-chat-and-generation.html">Chat and Generation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/hub-datasets-and-modeling.html">Hub, Datasets, and Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/anthropic-economic-index.html">Anthropic Economic Index</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/farach/huggingfaceR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Embeddings, Similarity, and Semantic Search</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/farach/huggingfaceR/blob/main/vignettes/embeddings-and-similarity.Rmd" class="external-link"><code>vignettes/embeddings-and-similarity.Rmd</code></a></small>
      <div class="d-none name"><code>embeddings-and-similarity.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">huggingfaceR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Text embeddings are dense numeric vectors that represent the semantic
content of text. Sentences with similar meanings produce vectors that
are close together in high-dimensional space, even if they use different
words. This property makes embeddings useful for similarity search,
clustering, topic modeling, and as features for machine learning.</p>
<p>huggingfaceR provides a complete embedding workflow: generate vectors
with <code><a href="../reference/hf_embed.html">hf_embed()</a></code>, measure similarity with
<code><a href="../reference/hf_similarity.html">hf_similarity()</a></code>, search with
<code><a href="../reference/hf_nearest_neighbors.html">hf_nearest_neighbors()</a></code>, cluster with
<code><a href="../reference/hf_cluster_texts.html">hf_cluster_texts()</a></code>, extract topics with
<code><a href="../reference/hf_extract_topics.html">hf_extract_topics()</a></code>, and visualize with
<code><a href="../reference/hf_embed_umap.html">hf_embed_umap()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="generating-embeddings-with-hf_embed">Generating Embeddings with hf_embed()<a class="anchor" aria-label="anchor" href="#generating-embeddings-with-hf_embed"></a>
</h2>
<div class="section level3">
<h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<p><code><a href="../reference/hf_embed.html">hf_embed()</a></code> accepts a character vector and returns a
tibble with three columns: <code>text</code>, <code>embedding</code> (a
list-column of numeric vectors), and <code>n_dims</code> (the
dimensionality of each vector).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sentences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Machine learning is transforming healthcare"</span>,</span>
<span>  <span class="st">"Deep learning models require large datasets"</span>,</span>
<span>  <span class="st">"The weather forecast predicts rain tomorrow"</span>,</span>
<span>  <span class="st">"Clinical trials use statistical methods"</span>,</span>
<span>  <span class="st">"It will be sunny next week"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">embeddings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_embed.html">hf_embed</a></span><span class="op">(</span><span class="va">sentences</span><span class="op">)</span></span>
<span><span class="va">embeddings</span></span>
<span><span class="co">#&gt; # A tibble: 5 x 3</span></span>
<span><span class="co">#&gt;   text                                        embedding   n_dims</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                       &lt;list&gt;       &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Machine learning is transforming healthcare &lt;dbl [384]&gt;    384</span></span>
<span><span class="co">#&gt; 2 Deep learning models require large datasets &lt;dbl [384]&gt;    384</span></span>
<span><span class="co">#&gt; 3 The weather forecast predicts rain tomorrow &lt;dbl [384]&gt;    384</span></span>
<span><span class="co">#&gt; 4 Clinical trials use statistical methods     &lt;dbl [384]&gt;    384</span></span>
<span><span class="co">#&gt; 5 It will be sunny next week                  &lt;dbl [384]&gt;    384</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="accessing-the-vectors">Accessing the Vectors<a class="anchor" aria-label="anchor" href="#accessing-the-vectors"></a>
</h3>
<p>Each embedding is stored as a numeric vector inside the list-column.
You can extract individual vectors or convert the entire set to a
matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Single vector</span></span>
<span><span class="va">embeddings</span><span class="op">$</span><span class="va">embedding</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] -0.0234  0.0451  0.0123 ...</span></span>
<span></span>
<span><span class="co"># Convert to a matrix (rows = texts, columns = dimensions)</span></span>
<span><span class="va">emb_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">embeddings</span><span class="op">$</span><span class="va">embedding</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">emb_matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   5 384</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="choosing-a-model">Choosing a Model<a class="anchor" aria-label="anchor" href="#choosing-a-model"></a>
</h3>
<p>The default model (<code>BAAI/bge-small-en-v1.5</code>) produces
384-dimensional embeddings and offers a good balance of speed and
quality for English text. You can specify any feature-extraction model
from the Hub.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use a different embedding model</span></span>
<span><span class="va">embeddings_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_embed.html">hf_embed</a></span><span class="op">(</span></span>
<span>  <span class="va">sentences</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"BAAI/bge-base-en-v1.5"</span>  <span class="co"># 768-dimensional, higher quality</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th>Model</th>
<th>Dimensions</th>
<th>Characteristics</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>BAAI/bge-small-en-v1.5</code></td>
<td>384</td>
<td>Fast, good quality (default)</td>
</tr>
<tr class="even">
<td><code>BAAI/bge-base-en-v1.5</code></td>
<td>768</td>
<td>Higher quality, slower</td>
</tr>
<tr class="odd">
<td><code>intfloat/multilingual-e5-small</code></td>
<td>384</td>
<td>Multilingual support</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="pairwise-similarity-with-hf_similarity">Pairwise Similarity with hf_similarity()<a class="anchor" aria-label="anchor" href="#pairwise-similarity-with-hf_similarity"></a>
</h2>
<p><code><a href="../reference/hf_similarity.html">hf_similarity()</a></code> computes cosine similarity between all
pairs of embeddings. Cosine similarity ranges from -1 (opposite) to 1
(identical), with values near 0 indicating no semantic relationship.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hf_similarity.html">hf_similarity</a></span><span class="op">(</span><span class="va">embeddings</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 x 3</span></span>
<span><span class="co">#&gt;    text_1                                       text_2                      similarity</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                                        &lt;chr&gt;                            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Machine learning is transforming healthcare  Deep learning models ...         0.82</span></span>
<span><span class="co">#&gt;  2 Machine learning is transforming healthcare  The weather forecast ...         0.15</span></span>
<span><span class="co">#&gt;  3 Machine learning is transforming healthcare  Clinical trials use ...          0.61</span></span>
<span><span class="co">#&gt;  4 Machine learning is transforming healthcare  It will be sunny ...             0.12</span></span>
<span><span class="co">#&gt;  5 Deep learning models require large datasets  The weather forecast ...         0.11</span></span>
<span><span class="co">#&gt; ...</span></span></code></pre></div>
<p>Texts about related topics (ML and healthcare, ML and statistics)
score highly, while unrelated pairs (ML and weather) score near zero.
This is the foundation for semantic search and document
deduplication.</p>
</div>
<div class="section level2">
<h2 id="tidytext-integration-hf_embed_text">Tidytext Integration: hf_embed_text()<a class="anchor" aria-label="anchor" href="#tidytext-integration-hf_embed_text"></a>
</h2>
<p>For data frame workflows, <code><a href="../reference/hf_embed_text.html">hf_embed_text()</a></code> adds
embeddings directly to an existing tibble. This is the recommended entry
point when you already have structured data.</p>
<div class="section level3">
<h3 id="embedding-a-data-frame">Embedding a Data Frame<a class="anchor" aria-label="anchor" href="#embedding-a-data-frame"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">docs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  doc_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>  category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tech"</span>, <span class="st">"tech"</span>, <span class="st">"food"</span>, <span class="st">"food"</span>, <span class="st">"travel"</span>, <span class="st">"travel"</span><span class="op">)</span>,</span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Neural networks power modern AI systems"</span>,</span>
<span>    <span class="st">"Cloud computing enables scalable applications"</span>,</span>
<span>    <span class="st">"Fresh pasta requires only flour and eggs"</span>,</span>
<span>    <span class="st">"Sourdough bread needs a mature starter"</span>,</span>
<span>    <span class="st">"Tokyo offers incredible street food and temples"</span>,</span>
<span>    <span class="st">"The Swiss Alps provide world-class hiking trails"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">docs_embedded</span> <span class="op">&lt;-</span> <span class="va">docs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_embed_text.html">hf_embed_text</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<p>The result retains all original columns and adds
<code>embedding</code> and <code>n_dims</code>.</p>
</div>
<div class="section level3">
<h3 id="semantic-search-with-hf_nearest_neighbors">Semantic Search with hf_nearest_neighbors()<a class="anchor" aria-label="anchor" href="#semantic-search-with-hf_nearest_neighbors"></a>
</h3>
<p>Find the documents most similar to a query string. The function
embeds the query, computes cosine similarity against all documents, and
returns the top matches.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">docs_embedded</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_nearest_neighbors.html">hf_nearest_neighbors</a></span><span class="op">(</span><span class="st">"artificial intelligence applications"</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 x 5</span></span>
<span><span class="co">#&gt;   doc_id category text                                      similarity</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                                          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1      1 tech     Neural networks power modern AI systems        0.78</span></span>
<span><span class="co">#&gt; 2      2 tech     Cloud computing enables scalable applic...     0.52</span></span>
<span><span class="co">#&gt; 3      5 travel   Tokyo offers incredible street food ...        0.18</span></span></code></pre></div>
<p>This pattern is useful for FAQ matching, document retrieval, and
recommendation systems.</p>
</div>
</div>
<div class="section level2">
<h2 id="clustering-with-hf_cluster_texts">Clustering with hf_cluster_texts()<a class="anchor" aria-label="anchor" href="#clustering-with-hf_cluster_texts"></a>
</h2>
<p><code><a href="../reference/hf_cluster_texts.html">hf_cluster_texts()</a></code> performs k-means clustering on the
embedding vectors, grouping semantically similar texts together. The
data must already have an <code>embedding</code> column (from
<code><a href="../reference/hf_embed_text.html">hf_embed_text()</a></code> or <code><a href="../reference/hf_embed.html">hf_embed()</a></code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">articles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="co"># Technology cluster</span></span>
<span>    <span class="st">"New AI chip doubles processing speed"</span>,</span>
<span>    <span class="st">"Quantum computing reaches error correction milestone"</span>,</span>
<span>    <span class="st">"Open-source language model rivals proprietary alternatives"</span>,</span>
<span>    <span class="st">"Cybersecurity threats increase with IoT adoption"</span>,</span>
<span>    <span class="co"># Health cluster</span></span>
<span>    <span class="st">"Mediterranean diet linked to reduced heart disease risk"</span>,</span>
<span>    <span class="st">"New gene therapy shows promise for rare blood disorders"</span>,</span>
<span>    <span class="st">"Sleep quality affects cognitive performance in older adults"</span>,</span>
<span>    <span class="st">"Vaccine development accelerates with mRNA technology"</span>,</span>
<span>    <span class="co"># Environment cluster</span></span>
<span>    <span class="st">"Arctic ice loss accelerates beyond model predictions"</span>,</span>
<span>    <span class="st">"Renewable energy capacity surpasses coal globally"</span>,</span>
<span>    <span class="st">"Ocean acidification threatens coral reef ecosystems"</span>,</span>
<span>    <span class="st">"Urban forests reduce city temperatures by up to 5 degrees"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">clustered</span> <span class="op">&lt;-</span> <span class="va">articles</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_embed_text.html">hf_embed_text</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_cluster_texts.html">hf_cluster_texts</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clustered</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">cluster</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span></span></code></pre></div>
<p>The resulting <code>cluster</code> column assigns each text to a
group. Texts about similar topics should be assigned to the same
cluster.</p>
</div>
<div class="section level2">
<h2 id="topic-extraction-with-hf_extract_topics">Topic Extraction with hf_extract_topics()<a class="anchor" aria-label="anchor" href="#topic-extraction-with-hf_extract_topics"></a>
</h2>
<p><code><a href="../reference/hf_extract_topics.html">hf_extract_topics()</a></code> builds on clustering by extracting
representative keywords for each cluster. This requires the
<code>tidytext</code> package for tokenization and TF-IDF
computation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://juliasilge.github.io/tidytext/" class="external-link">tidytext</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">topics</span> <span class="op">&lt;-</span> <span class="va">articles</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_embed_text.html">hf_embed_text</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_extract_topics.html">hf_extract_topics</a></span><span class="op">(</span>text_col <span class="op">=</span> <span class="st">"text"</span>, k <span class="op">=</span> <span class="fl">3</span>, top_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">topics</span></span>
<span><span class="co">#&gt; # A tibble: 15 x 3</span></span>
<span><span class="co">#&gt;    cluster word           tf_idf</span></span>
<span><span class="co">#&gt;      &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1       1 ai             0.231</span></span>
<span><span class="co">#&gt;  2       1 computing      0.198</span></span>
<span><span class="co">#&gt;  3       1 chip           0.165</span></span>
<span><span class="co">#&gt; ...</span></span></code></pre></div>
<p>Each cluster is described by the words most distinctive to its
documents, making it straightforward to assign human-readable topic
labels.</p>
</div>
<div class="section level2">
<h2 id="visualization-with-hf_embed_umap">Visualization with hf_embed_umap()<a class="anchor" aria-label="anchor" href="#visualization-with-hf_embed_umap"></a>
</h2>
<p><code><a href="../reference/hf_embed_umap.html">hf_embed_umap()</a></code> reduces high-dimensional embeddings to
2D coordinates using UMAP (Uniform Manifold Approximation and
Projection), suitable for scatter plot visualization. This function
requires the <code>uwot</code> package.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">texts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="co"># Animals</span></span>
<span>  <span class="st">"cats are independent pets"</span>, <span class="st">"dogs are loyal companions"</span>,</span>
<span>  <span class="st">"goldfish are low-maintenance pets"</span>, <span class="st">"parrots can mimic speech"</span>,</span>
<span>  <span class="co"># Vehicles</span></span>
<span></span>
<span>  <span class="st">"sedans are practical family cars"</span>, <span class="st">"trucks haul heavy loads"</span>,</span>
<span>  <span class="st">"bicycles reduce carbon emissions"</span>, <span class="st">"motorcycles offer speed and freedom"</span>,</span>
<span>  <span class="co"># Food</span></span>
<span>  <span class="st">"pizza is a popular dinner choice"</span>, <span class="st">"sushi requires fresh fish"</span>,</span>
<span>  <span class="st">"tacos feature various fillings"</span>, <span class="st">"pasta comes in many shapes"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_embed_umap.html">hf_embed_umap</a></span><span class="op">(</span><span class="va">texts</span>, n_neighbors <span class="op">=</span> <span class="fl">4</span>, min_dist <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">coords</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">umap_1</span>, <span class="va">umap_2</span>, label <span class="op">=</span> <span class="va">text</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, nudge_x <span class="op">=</span> <span class="fl">0.02</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"UMAP Projection of Text Embeddings"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"UMAP 1"</span>, y <span class="op">=</span> <span class="st">"UMAP 2"</span><span class="op">)</span></span></code></pre></div>
<p>Semantically related texts cluster together in the 2D projection. The
<code>n_neighbors</code> and <code>min_dist</code> parameters control
the trade-off between preserving local versus global structure.</p>
</div>
<div class="section level2">
<h2 id="practical-example-document-similarity-analysis">Practical Example: Document Similarity Analysis<a class="anchor" aria-label="anchor" href="#practical-example-document-similarity-analysis"></a>
</h2>
<p>This end-to-end example combines embedding, clustering, and
visualization to analyze a set of research paper abstracts.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate research abstracts from three fields</span></span>
<span><span class="va">abstracts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  paper_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span>
<span>  field <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NLP"</span>, <span class="st">"genomics"</span>, <span class="st">"climate"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  abstract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Transformer architectures improve machine translation quality"</span>,</span>
<span>    <span class="st">"Attention mechanisms capture long-range text dependencies"</span>,</span>
<span>    <span class="st">"Pre-training on large corpora enables few-shot learning"</span>,</span>
<span>    <span class="st">"Named entity recognition benefits from contextual embeddings"</span>,</span>
<span>    <span class="st">"Sentiment analysis models generalize across domains"</span>,</span>
<span>    <span class="st">"CRISPR enables precise genome editing in mammalian cells"</span>,</span>
<span>    <span class="st">"Single-cell RNA sequencing reveals cell type heterogeneity"</span>,</span>
<span>    <span class="st">"Epigenetic modifications regulate gene expression patterns"</span>,</span>
<span>    <span class="st">"Protein folding prediction reaches experimental accuracy"</span>,</span>
<span>    <span class="st">"Microbiome composition correlates with metabolic health"</span>,</span>
<span>    <span class="st">"Global temperatures rise faster than model projections"</span>,</span>
<span>    <span class="st">"Carbon capture technology scales to industrial levels"</span>,</span>
<span>    <span class="st">"Sea level rise threatens coastal infrastructure worldwide"</span>,</span>
<span>    <span class="st">"Deforestation reduces regional precipitation patterns"</span>,</span>
<span>    <span class="st">"Methane emissions from permafrost accelerate warming"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Embed, cluster, and project to 2D</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">abstracts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_embed_text.html">hf_embed_text</a></span><span class="op">(</span><span class="va">abstract</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/hf_cluster_texts.html">hf_cluster_texts</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_embed_umap.html">hf_embed_umap</a></span><span class="op">(</span><span class="va">abstracts</span><span class="op">$</span><span class="va">abstract</span>, n_neighbors <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="va">result</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">paper_id</span>, <span class="va">field</span>, <span class="va">cluster</span><span class="op">)</span>,</span>
<span>  <span class="va">coords</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">umap_1</span>, <span class="va">umap_2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">umap_1</span>, <span class="va">umap_2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>, shape <span class="op">=</span> <span class="va">field</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Research Abstracts by Embedding Cluster"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Cluster"</span>,</span>
<span>    shape <span class="op">=</span> <span class="st">"True Field"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>When the embedding model captures domain-specific semantics, the
automatically discovered clusters should align with the true research
fields.</p>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<a href="getting-started.html">Getting Started</a> – installation
and authentication.</li>
<li>
<a href="hub-datasets-and-modeling.html">Hub Discovery, Datasets,
and Tidymodels Integration</a> – using embeddings as features in
supervised learning pipelines.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Farach, Sam Terfa, Jack Penzer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> | <a href="https://github.com/farach/huggingfaceR" class="external-link">View on GitHub</a></p>
</div>

    </footer>
</div>





  </body>
</html>
