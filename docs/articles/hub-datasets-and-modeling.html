<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Hub Discovery, Datasets, and Tidymodels Integration • huggingfaceR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hub Discovery, Datasets, and Tidymodels Integration">
<link rel="icon" type="image/svg+xml" href="favicon/favicon.svg">
<meta property="og:image" content="https://farach.github.io/huggingfaceR/logo.svg">
<meta name="twitter:card" content="summary">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">huggingfaceR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book-open"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with huggingfaceR</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core Capabilities</h6></li>
    <li><a class="dropdown-item" href="../articles/text-classification.html">Text Classification</a></li>
    <li><a class="dropdown-item" href="../articles/embeddings-and-similarity.html">Embeddings and Similarity</a></li>
    <li><a class="dropdown-item" href="../articles/llm-chat-and-generation.html">Chat and Generation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/hub-datasets-and-modeling.html">Hub, Datasets, and Modeling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Case Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/anthropic-economic-index.html">Anthropic Economic Index</a></li>
    <li><a class="dropdown-item" href="../articles/openai-gdpval-benchmark.html">OpenAI GDPval Benchmark</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/farach/huggingfaceR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Hub Discovery, Datasets, and Tidymodels Integration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/farach/huggingfaceR/blob/main/vignettes/hub-datasets-and-modeling.Rmd" class="external-link"><code>vignettes/hub-datasets-and-modeling.Rmd</code></a></small>
      <div class="d-none name"><code>hub-datasets-and-modeling.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">huggingfaceR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The Hugging Face Hub hosts over 500,000 models and 100,000 datasets.
huggingfaceR provides functions to search this registry, load data
directly into tibbles, and integrate embeddings into tidymodels machine
learning workflows – all without leaving R.</p>
</div>
<div class="section level2">
<h2 id="searching-models">Searching Models<a class="anchor" aria-label="anchor" href="#searching-models"></a>
</h2>
<div class="section level3">
<h3 id="by-task">By Task<a class="anchor" aria-label="anchor" href="#by-task"></a>
</h3>
<p><code><a href="../reference/hf_search_models.html">hf_search_models()</a></code> queries the Hub and returns a tibble
of matching models. The <code>task</code> parameter filters by pipeline
type.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Text classification models</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span>task <span class="op">=</span> <span class="st">"text-classification"</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 x 7</span></span>
<span><span class="co">#&gt;    model_id                              author    task                downloads  likes tags     library</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                                 &lt;chr&gt;     &lt;chr&gt;                   &lt;int&gt;  &lt;int&gt; &lt;list&gt;   &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 distilbert/distilbert-base-uncased... distilbert text-classification  5234891   412 &lt;chr&gt;    transformers</span></span>
<span><span class="co">#&gt;  2 ...</span></span>
<span></span>
<span><span class="co"># Embedding models</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span>task <span class="op">=</span> <span class="st">"feature-extraction"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Text generation models</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span>task <span class="op">=</span> <span class="st">"text-generation"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="by-author-or-search-term">By Author or Search Term<a class="anchor" aria-label="anchor" href="#by-author-or-search-term"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Models from a specific organization</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span>author <span class="op">=</span> <span class="st">"facebook"</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Free-text search</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"sentiment english"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine filters</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="st">"text-classification"</span>,</span>
<span>  search <span class="op">=</span> <span class="st">"emotion"</span>,</span>
<span>  sort <span class="op">=</span> <span class="st">"likes"</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sorting-and-pagination">Sorting and Pagination<a class="anchor" aria-label="anchor" href="#sorting-and-pagination"></a>
</h3>
<p>Results can be sorted by <code>"downloads"</code> or
<code>"likes"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Most downloaded fill-mask models</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="st">"fill-mask"</span>,</span>
<span>  sort <span class="op">=</span> <span class="st">"downloads"</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Most liked text-generation models</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="st">"text-generation"</span>,</span>
<span>  sort <span class="op">=</span> <span class="st">"likes"</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-discovery-to-usage">From Discovery to Usage<a class="anchor" aria-label="anchor" href="#from-discovery-to-usage"></a>
</h3>
<p>Model IDs returned by <code><a href="../reference/hf_search_models.html">hf_search_models()</a></code> can be passed
directly to inference functions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find a model</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span>task <span class="op">=</span> <span class="st">"text-classification"</span>, search <span class="op">=</span> <span class="st">"emotion"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use it for classification</span></span>
<span><span class="fu"><a href="../reference/hf_classify.html">hf_classify</a></span><span class="op">(</span></span>
<span>  <span class="st">"I'm so happy today!"</span>,</span>
<span>  model <span class="op">=</span> <span class="va">models</span><span class="op">$</span><span class="va">model_id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model-details">Model Details<a class="anchor" aria-label="anchor" href="#model-details"></a>
</h2>
<div class="section level3">
<h3 id="inspecting-a-specific-model">Inspecting a Specific Model<a class="anchor" aria-label="anchor" href="#inspecting-a-specific-model"></a>
</h3>
<p><code><a href="../reference/hf_model_info.html">hf_model_info()</a></code> returns detailed metadata for a single
model, including its tags, library, pipeline type, and download
statistics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_model_info.html">hf_model_info</a></span><span class="op">(</span><span class="st">"BAAI/bge-small-en-v1.5"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Key fields</span></span>
<span><span class="va">info</span><span class="op">$</span><span class="va">pipeline_tag</span></span>
<span><span class="co">#&gt; [1] "feature-extraction"</span></span>
<span></span>
<span><span class="va">info</span><span class="op">$</span><span class="va">downloads</span></span>
<span><span class="co">#&gt; [1] 12345678</span></span>
<span></span>
<span><span class="va">info</span><span class="op">$</span><span class="va">tags</span></span>
<span><span class="co">#&gt; [1] "feature-extraction" "embeddings" "sentence-similarity" ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="listing-available-tasks">Listing Available Tasks<a class="anchor" aria-label="anchor" href="#listing-available-tasks"></a>
</h3>
<p><code><a href="../reference/hf_list_tasks.html">hf_list_tasks()</a></code> returns all task types recognized by the
Hub. Use the <code>pattern</code> parameter to filter by regex.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All tasks</span></span>
<span><span class="fu"><a href="../reference/hf_list_tasks.html">hf_list_tasks</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Only classification-related tasks</span></span>
<span><span class="fu"><a href="../reference/hf_list_tasks.html">hf_list_tasks</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "text-classification"      "token-classification"</span></span>
<span><span class="co">#&gt; [3] "zero-shot-classification" "image-classification"</span></span>
<span><span class="co">#&gt; [5] "audio-classification"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="searching-datasets">Searching Datasets<a class="anchor" aria-label="anchor" href="#searching-datasets"></a>
</h2>
<p><code><a href="../reference/hf_search_datasets.html">hf_search_datasets()</a></code> queries the Hub’s dataset registry.
The interface mirrors <code><a href="../reference/hf_search_models.html">hf_search_models()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find sentiment datasets</span></span>
<span><span class="fu"><a href="../reference/hf_search_datasets.html">hf_search_datasets</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"sentiment"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 x 5</span></span>
<span><span class="co">#&gt;   dataset_id               author    downloads  likes tags</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                    &lt;chr&gt;         &lt;int&gt;  &lt;int&gt; &lt;list&gt;</span></span>
<span></span>
<span><span class="co"># Filter by task</span></span>
<span><span class="fu"><a href="../reference/hf_search_datasets.html">hf_search_datasets</a></span><span class="op">(</span>task <span class="op">=</span> <span class="st">"text-classification"</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sort by popularity</span></span>
<span><span class="fu"><a href="../reference/hf_search_datasets.html">hf_search_datasets</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"translation"</span>, sort <span class="op">=</span> <span class="st">"likes"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-datasets-with-hf_load_dataset">Loading Datasets with hf_load_dataset()<a class="anchor" aria-label="anchor" href="#loading-datasets-with-hf_load_dataset"></a>
</h2>
<div class="section level3">
<h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<p><code><a href="../reference/hf_load_dataset.html">hf_load_dataset()</a></code> fetches dataset rows from the Hub’s
Datasets Server API and returns them as a tibble. No Python or local
downloads are required.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"imdb"</span>, split <span class="op">=</span> <span class="st">"train"</span>, limit <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">imdb</span></span>
<span><span class="co">#&gt; # A tibble: 100 x 4</span></span>
<span><span class="co">#&gt;    text                                                    label .dataset .split</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                                                   &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 I rented I AM CURIOUS-YELLOW from my video store be...      0 stanfo...  train</span></span>
<span><span class="co">#&gt;  2 "\"I Am Curious: Yellow\" is a risque a]nd target...        0 stanfo...  train</span></span>
<span><span class="co">#&gt; ...</span></span></code></pre></div>
<p>The function automatically resolves short dataset names (e.g.,
<code>"imdb"</code> becomes <code>"stanfordnlp/imdb"</code>) and detects
the appropriate configuration.</p>
</div>
<div class="section level3">
<h3 id="configs-and-splits">Configs and Splits<a class="anchor" aria-label="anchor" href="#configs-and-splits"></a>
</h3>
<p>Some datasets have multiple configurations (subsets). The
<code>config</code> parameter lets you specify which one to load. When
omitted, the default config is auto-detected.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Explicitly specify a config</span></span>
<span><span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"stanfordnlp/imdb"</span>, split <span class="op">=</span> <span class="st">"test"</span>, config <span class="op">=</span> <span class="st">"plain_text"</span>, limit <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Different splits</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"imdb"</span>, split <span class="op">=</span> <span class="st">"train"</span>, limit <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"imdb"</span>, split <span class="op">=</span> <span class="st">"test"</span>, limit <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pagination-for-large-datasets">Pagination for Large Datasets<a class="anchor" aria-label="anchor" href="#pagination-for-large-datasets"></a>
</h3>
<p>Use <code>offset</code> to paginate through large datasets in
batches.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First 1000 rows</span></span>
<span><span class="va">batch1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"imdb"</span>, split <span class="op">=</span> <span class="st">"train"</span>, limit <span class="op">=</span> <span class="fl">1000</span>, offset <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Next 1000 rows</span></span>
<span><span class="va">batch2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"imdb"</span>, split <span class="op">=</span> <span class="st">"train"</span>, limit <span class="op">=</span> <span class="fl">1000</span>, offset <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine</span></span>
<span><span class="va">full_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">batch1</span>, <span class="va">batch2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dataset-metadata">Dataset Metadata<a class="anchor" aria-label="anchor" href="#dataset-metadata"></a>
</h3>
<p><code><a href="../reference/hf_dataset_info.html">hf_dataset_info()</a></code> returns metadata about a dataset
without downloading any rows.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_dataset_info.html">hf_dataset_info</a></span><span class="op">(</span><span class="st">"imdb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="tidymodels-integration-with-step_hf_embed">Tidymodels Integration with step_hf_embed()<a class="anchor" aria-label="anchor" href="#tidymodels-integration-with-step_hf_embed"></a>
</h2>
<div class="section level3">
<h3 id="the-recipe-step">The Recipe Step<a class="anchor" aria-label="anchor" href="#the-recipe-step"></a>
</h3>
<p><code><a href="../reference/step_hf_embed.html">step_hf_embed()</a></code> is a tidymodels recipe step that
converts text columns into embedding features during the
<code>prep()</code>/<code>bake()</code> workflow. Each text column is
replaced by numeric columns named <code>{column}_emb_1</code>,
<code>{column}_emb_2</code>, …, <code>{column}_emb_384</code> (one per
embedding dimension).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sample data</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"This movie was fantastic, truly moving"</span>,</span>
<span>    <span class="st">"Terrible acting and boring plot"</span>,</span>
<span>    <span class="st">"A masterpiece of modern cinema"</span>,</span>
<span>    <span class="st">"Waste of time, do not watch"</span>,</span>
<span>    <span class="st">"Beautiful story and great performances"</span>,</span>
<span>    <span class="st">"Dull and predictable from start to finish"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  sentiment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pos"</span>, <span class="st">"neg"</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a recipe with embedding features</span></span>
<span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">sentiment</span> <span class="op">~</span> <span class="va">text</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/step_hf_embed.html">step_hf_embed</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prep computes column metadata</span></span>
<span><span class="va">rec_prepped</span> <span class="op">&lt;-</span> <span class="fu">prep</span><span class="op">(</span><span class="va">rec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bake generates the actual embeddings</span></span>
<span><span class="va">baked</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">rec_prepped</span>, new_data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">baked</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "text_emb_1" "text_emb_2" "text_emb_3" "text_emb_4" "text_emb_5"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">baked</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   6 385  # 384 embedding dims + 1 outcome column</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="complete-classification-workflow">Complete Classification Workflow<a class="anchor" aria-label="anchor" href="#complete-classification-workflow"></a>
</h3>
<p>This example builds a full supervised learning pipeline: load data
from the Hub, create embeddings with a recipe, train a model, and
evaluate predictions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load labeled data</span></span>
<span><span class="va">imdb_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"imdb"</span>, split <span class="op">=</span> <span class="st">"train"</span>, limit <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sentiment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">sentiment</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imdb_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"imdb"</span>, split <span class="op">=</span> <span class="st">"test"</span>, limit <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sentiment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">sentiment</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define recipe</span></span>
<span><span class="va">embedding_recipe</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">sentiment</span> <span class="op">~</span> <span class="va">text</span>, data <span class="op">=</span> <span class="va">imdb_train</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/step_hf_embed.html">step_hf_embed</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define model</span></span>
<span><span class="va">lr_model</span> <span class="op">&lt;-</span> <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build workflow</span></span>
<span><span class="va">wf</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">embedding_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">lr_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train</span></span>
<span><span class="va">fitted_wf</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">wf</span>, data <span class="op">=</span> <span class="va">imdb_train</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict on test set</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fitted_wf</span>, new_data <span class="op">=</span> <span class="va">imdb_test</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">imdb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate</span></span>
<span><span class="va">predictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">metrics</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">sentiment</span>, estimate <span class="op">=</span> <span class="va">.pred_class</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-a-different-embedding-model">Using a Different Embedding Model<a class="anchor" aria-label="anchor" href="#using-a-different-embedding-model"></a>
</h3>
<p>The <code>model</code> parameter in <code><a href="../reference/step_hf_embed.html">step_hf_embed()</a></code>
specifies which embedding model to use. Different models may produce
different feature quality depending on the domain.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Higher-dimensional embeddings</span></span>
<span><span class="fu">recipe</span><span class="op">(</span><span class="va">sentiment</span> <span class="op">~</span> <span class="va">text</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/step_hf_embed.html">step_hf_embed</a></span><span class="op">(</span><span class="va">text</span>, model <span class="op">=</span> <span class="st">"BAAI/bge-base-en-v1.5"</span><span class="op">)</span>  <span class="co"># 768 dims</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inspecting-and-tuning-the-step">Inspecting and Tuning the Step<a class="anchor" aria-label="anchor" href="#inspecting-and-tuning-the-step"></a>
</h3>
<p><code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> extracts the step’s configuration, and
<code>tunable()</code> reports which parameters support tuning.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View step configuration</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">rec_prepped</span>, number <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check tunable parameters</span></span>
<span><span class="fu">tunable</span><span class="op">(</span><span class="va">rec_prepped</span><span class="op">$</span><span class="va">steps</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="practical-considerations">Practical Considerations<a class="anchor" aria-label="anchor" href="#practical-considerations"></a>
</h3>
<ul>
<li>
<strong>API rate limits.</strong> <code>bake()</code> makes one API
call per text row. For large datasets, pre-compute embeddings using
<code><a href="../reference/hf_embed_chunks.html">hf_embed_chunks()</a></code> which processes texts in parallel, writes
checkpoints to disk (parquet format), and supports resume on
interruption. Then read results with <code><a href="../reference/hf_read_chunks.html">hf_read_chunks()</a></code>.</li>
<li>
<strong>Caching strategy.</strong> Compute embeddings once on the
training set during <code>prep()</code>, then reuse for predictions. The
recipe stores the trained step configuration.</li>
<li>
<strong>Batch processing.</strong> For datasets too large for
<code><a href="../reference/step_hf_embed.html">step_hf_embed()</a></code>, use <code><a href="../reference/hf_embed_batch.html">hf_embed_batch()</a></code>
(in-memory parallel) or <code><a href="../reference/hf_embed_chunks.html">hf_embed_chunks()</a></code> (disk
checkpoints) to pre-compute embeddings, then join them to your training
data.</li>
<li>
<strong>Model selection.</strong> Smaller embedding models (384
dims) train downstream models faster. Larger models (768+ dims) may
improve accuracy for nuanced tasks. Experiment on a validation set.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="end-to-end-example-topic-classification-pipeline">End-to-End Example: Topic Classification Pipeline<a class="anchor" aria-label="anchor" href="#end-to-end-example-topic-classification-pipeline"></a>
</h2>
<p>This example combines Hub discovery, dataset loading, and modeling
into a complete workflow.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 1: Discover a suitable dataset</span></span>
<span><span class="fu"><a href="../reference/hf_search_datasets.html">hf_search_datasets</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"news classification"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Load and prepare data</span></span>
<span><span class="va">news_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"stanfordnlp/imdb"</span>, split <span class="op">=</span> <span class="st">"train"</span>, limit <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"positive"</span>, <span class="st">"negative"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">label</span><span class="op">)</span></span>
<span></span>
<span><span class="va">news_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hf_load_dataset.html">hf_load_dataset</a></span><span class="op">(</span><span class="st">"stanfordnlp/imdb"</span>, split <span class="op">=</span> <span class="st">"test"</span>, limit <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"positive"</span>, <span class="st">"negative"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">label</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Find a good embedding model</span></span>
<span><span class="fu"><a href="../reference/hf_search_models.html">hf_search_models</a></span><span class="op">(</span>task <span class="op">=</span> <span class="st">"feature-extraction"</span>, search <span class="op">=</span> <span class="st">"bge"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 4: Build and train the pipeline</span></span>
<span><span class="va">wf</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span></span>
<span>    <span class="fu">recipe</span><span class="op">(</span><span class="va">label</span> <span class="op">~</span> <span class="va">text</span>, data <span class="op">=</span> <span class="va">news_train</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="../reference/step_hf_embed.html">step_hf_embed</a></span><span class="op">(</span><span class="va">text</span>, model <span class="op">=</span> <span class="st">"BAAI/bge-small-en-v1.5"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitted</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">wf</span>, data <span class="op">=</span> <span class="va">news_train</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 5: Evaluate</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fitted</span>, <span class="va">news_test</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">news_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">conf_mat</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">label</span>, estimate <span class="op">=</span> <span class="va">.pred_class</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">metrics</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">label</span>, estimate <span class="op">=</span> <span class="va">.pred_class</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<a href="getting-started.html">Getting Started</a> – installation
and authentication.</li>
<li>
<a href="embeddings-and-similarity.html">Embeddings, Similarity, and
Semantic Search</a> – understanding embeddings, similarity, and
unsupervised analysis.</li>
<li>
<a href="text-classification.html">Text Classification</a> – direct
API-based classification without training a model.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Farach, Sam Terfa, Jack Penzer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> | <a href="https://github.com/farach/huggingfaceR" class="external-link">View on GitHub</a></p>
</div>

    </footer>
</div>





  </body>
</html>
